// Map Chinese (and other) aliases to canonical tool names
export function normalizeToolName(rawName: string): string {
  if (!rawName) return rawName;
  const n = rawName.trim().toLowerCase();
  const map: Record<string, string> = {
    // locale
    'set_locale': 'set_locale',
    '设置语言': 'set_locale',
    '设置本地化': 'set_locale',
    '切换语言': 'set_locale',
    // auth
    'authenticate': 'authenticate',
    '认证': 'authenticate',
    '授权': 'authenticate',
    '登录': 'authenticate',
    'exchange_code_for_token': 'exchange_code_for_token',
    '用授权码换令牌': 'exchange_code_for_token',
    '交换令牌': 'exchange_code_for_token',
    'refresh_token': 'refresh_token',
    '刷新令牌': 'refresh_token',
    'get_user_info': 'get_user_info',
    '获取用户信息': 'get_user_info',
    '用户信息': 'get_user_info',
    'set_access_token': 'set_access_token',
    '设置访问令牌': 'set_access_token',
    'get_auth_status': 'get_auth_status',
    '获取认证状态': 'get_auth_status',
    '认证状态': 'get_auth_status',
    'clear_auth': 'clear_auth',
    '清除认证': 'clear_auth',
    // memory
    'add_memory': 'add_memory',
    '创建记忆': 'add_memory',
    '添加记忆': 'add_memory',
    '新增记忆': 'add_memory',
    'search_memories': 'search_memories',
    '搜索记忆': 'search_memories',
    '查找记忆': 'search_memories',
    '检索记忆': 'search_memories',
    'get_memory': 'get_memory',
    '获取记忆': 'get_memory',
    'update_memory': 'update_memory',
    '更新记忆': 'update_memory',
    '修改记忆': 'update_memory',
    'delete_memory': 'delete_memory',
    '删除记忆': 'delete_memory',
    'get_memory_stats': 'get_memory_stats',
    '记忆统计': 'get_memory_stats',
    '获取记忆统计': 'get_memory_stats',
    // activity
    'create_activity': 'create_activity',
    '创建活动': 'create_activity',
    '记录活动': 'create_activity',
    '添加活动': 'create_activity',
    'search_activities': 'search_activities',
    '搜索活动': 'search_activities',
    '查找活动': 'search_activities',
    'get_activity': 'get_activity',
    '获取活动': 'get_activity',
    'update_activity': 'update_activity',
    '更新活动': 'update_activity',
    '修改活动': 'update_activity',
    'get_activity_stats': 'get_activity_stats',
    '活动统计': 'get_activity_stats',
    // timeline
    'get_timeline_items': 'get_timeline_items',
    '获取时间线': 'get_timeline_items',
    '时间线条目': 'get_timeline_items',
    '查看时间线': 'get_timeline_items',
    'create_timeline_item': 'create_timeline_item',
    '创建时间线条目': 'create_timeline_item',
    '新增时间线条目': 'create_timeline_item',
    'get_timeline_insights': 'get_timeline_insights',
    '时间线洞察': 'get_timeline_insights',
    '时间洞察': 'get_timeline_insights',
    '生产力洞察': 'get_timeline_insights',
    'search_across_timeline': 'search_across_timeline',
    '跨时间线搜索': 'search_across_timeline',
    '跨类型搜索': 'search_across_timeline',
    // tasks
    'create_task': 'create_task',
    '创建任务': 'create_task',
    '添加任务': 'create_task',
    '新建任务': 'create_task',
    'search_tasks': 'search_tasks',
    '搜索任务': 'search_tasks',
    '查找任务': 'search_tasks',
    'get_task': 'get_task',
    '获取任务': 'get_task',
    'update_task': 'update_task',
    '更新任务': 'update_task',
    '修改任务': 'update_task',
    'get_task_stats': 'get_task_stats',
    '任务统计': 'get_task_stats',
    '查看任务统计': 'get_task_stats',
    'get_task_updates_for_today': 'get_task_updates_for_today',
    '今日任务更新': 'get_task_updates_for_today',
    '获取今日任务更新': 'get_task_updates_for_today',
    'get_task_updates_for_date': 'get_task_updates_for_date',
    '指定日期任务更新': 'get_task_updates_for_date',
    '获取某日任务更新': 'get_task_updates_for_date',
    // time
    'get_day_time_spending': 'get_day_time_spending',
    '获取时间花费': 'get_day_time_spending',
    '时间花费': 'get_day_time_spending',
    '日时间统计': 'get_day_time_spending',
    'get_task_time_entries': 'get_task_time_entries',
    '任务时间记录': 'get_task_time_entries',
    '查看任务时间记录': 'get_task_time_entries',
    'start_task_timer': 'start_task_timer',
    '开始任务计时': 'start_task_timer',
    '开始计时': 'start_task_timer',
    'stop_task_timer': 'stop_task_timer',
    '停止任务计时': 'stop_task_timer',
    '停止计时': 'stop_task_timer',
    'get_running_timer': 'get_running_timer',
    '当前计时器': 'get_running_timer',
    '获取正在运行的计时器': 'get_running_timer',
    // category
    'get_categories': 'get_categories',
    '获取分类': 'get_categories',
    '列出分类': 'get_categories',
    'create_category': 'create_category',
    '创建分类': 'create_category',
    '新增分类': 'create_category',
    'get_category': 'get_category',
    '获取分类详情': 'get_category',
    'update_category': 'update_category',
    '更新分类': 'update_category',
    // ai tasks
    'get_ai_tasks': 'get_ai_tasks',
    '获取ai任务': 'get_ai_tasks',
    'ai任务列表': 'get_ai_tasks',
    'get_queued_tasks_for_agent': 'get_queued_tasks_for_agent',
    '获取agent队列任务': 'get_queued_tasks_for_agent',
    'get_ai_task': 'get_ai_task',
    '获取ai任务详情': 'get_ai_task',
    'accept_ai_task': 'accept_ai_task',
    '接受ai任务': 'accept_ai_task',
    'update_ai_task': 'update_ai_task',
    '更新ai任务': 'update_ai_task',
    'complete_ai_task': 'complete_ai_task',
    '完成ai任务': 'complete_ai_task',
    'fail_ai_task': 'fail_ai_task',
    '标记ai任务失败': 'fail_ai_task',
    'get_ai_task_stats': 'get_ai_task_stats',
    'ai任务统计': 'get_ai_task_stats',
  };
  return map[n] || rawName;
}